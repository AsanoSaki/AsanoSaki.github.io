{"version":3,"sources":["kratosr.js"],"names":["_typeof","obj","Symbol","iterator","constructor","prototype","_regeneratorRuntime","exports","Op","Object","hasOwn","hasOwnProperty","$Symbol","iteratorSymbol","asyncIteratorSymbol","asyncIterator","toStringTagSymbol","toStringTag","define","key","value","defineProperty","enumerable","configurable","writable","err","wrap","innerFn","outerFn","self","tryLocsList","protoGenerator","Generator","generator","create","context","Context","_invoke","state","method","arg","Error","doneResult","delegate","delegateResult","maybeInvokeDelegate","ContinueSentinel","sent","_sent","dispatchException","abrupt","record","tryCatch","type","done","fn","call","GeneratorFunction","GeneratorFunctionPrototype","IteratorPrototype","this","getProto","getPrototypeOf","NativeIteratorPrototype","values","Gp","defineIteratorMethods","forEach","AsyncIterator","PromiseImpl","invoke","resolve","reject","result","__await","then","unwrapped","error","previousPromise","callInvokeWithMethodAndArg","undefined","return","TypeError","info","resultName","next","nextLoc","pushTryEntry","locs","entry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","push","resetTryEntry","completion","reset","iterable","iteratorMethod","isNaN","length","i","displayName","isGeneratorFunction","genFun","ctor","name","mark","setPrototypeOf","__proto__","awrap","async","Promise","iter","keys","object","reverse","pop","skipTempReset","prev","charAt","slice","stop","rootRecord","rval","exception","handle","loc","caught","hasCatch","hasFinally","finallyEntry","complete","finish","catch","thrown","delegateYield","asyncGeneratorStep","gen","_next","_throw","_asyncToGenerator","args","arguments","apply","window","requestIdleCallback","handler","startTime","Date","now","setTimeout","didTimeout","timeRemaining","Math","max","cancelIdleCallback","id","clearTimeout","copyrightString","loadConfig","_ref","_callee","_window$kr","url","_context","kr","siteRoot","fetch","json","docTitle","getTimeString","msec","tString","exact","sec","dnum","floor","hnum","mnum","snum","dstr","toString","hstr","mstr","sstr","makeDelay","callback","ms","timer","initPerPage","sidebarTocWidget","initFunc","document","getElementById","tocDOMs","getElementsByClassName","tocItems","Array","from","tocItem","linkItem","querySelector","titleText","decodeURI","getAttribute","substring","titleElem","setAttribute","at","el","e","console","log","message","classList","add","curTocId","tocActivate","newId","remove","nCur","contains","parentNode","applyDecision","pos","scrollY","requestAnimationFrame","observer","IntersectionObserver","entries","decision","currentIndex","Number","parseInt","target","isIntersecting","boundingClientRect","top","rootBounds","bottom","height","intersectionRatio","rootMargin","threshold","x","observe","addEventListener","disconnect","once","tocUpdatePos","h","getBoundingClientRect","tocGetId","newPos","isInteger","nowY","tocOnScroll","tocOnResize","removeEventListener","readProgBar","articleElem","setPercent","currentTop","documentElement","scrollTop","docHeight","clientHeight","winHeight","headerHeight","offsetTop","contentMath","scrollHeight","scrollPercent","min","scrollPercentRound","round","style","width","offsetParent","title","querySelectorAll","figure","count","getElementsByTagName","concat","innerHTML","ClipboardJS","on","origInner","trigger","clearSelection","$","fancybox","defaults","hash","each","find","parent","hasClass","is","alt","after","src","runningOnBrowser","isBot","navigator","test","userAgent","supportsIntersectionObserver","commsArea","loadwork","loadCommentsEventHandler","load_comm","commentsLazyLoad","initPerPageWithConfig","imageboxs","randomAmount","cover","baseUrl","coverFileNameTemplate","filenameTemplate","usedCovers","generateNewCoverID","coverNo","remailFailCounts","random","len","attr","coverFileName","replace","coverUrl","includes","loadRandomCover","copyrightNotice","location","href","setCopyright","expire_day","expireAlert","dateTimeTag","updateDateTime","gap","innerText","expireNotify","themeInit","isScrolledDown","pageScrollDownClass","$clone","body","oncopy","copiedContent","getSelection","preventDefault","clipboardData","setData","copyEventInit","siteLeaveEvent","titleTime","OriginLogo","hidden","leaveTitle","leaveLogo","returnTitle","leaveEventInit","createTime","upTimeNode","setInterval","initTime","layer","open","area","donateBtn","resize","scrollbar","content","scanNotice","qr_alipay","qr_wechat","click","removeClass","addClass","donateConfig","topNavScrollToggle","lastHeight","innerHeight","isTopNavHidden","topNavScrollToggleInit","event","animate","offset","clone","prepend","css","w","container","has","slideToggle","fadeToggle","MathJax","Hub","Typeset","readyState"],"mappings":"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","file":"../js/kratosr.min.js","sourcesContent":["/**\n * 因为后台任务API还是相当新的，而你的代码可能需要在那些仍不支持此API的浏览器上运行。\n * 你可以把 setTimeout() 用作回调选项来做这样的事。\n * 这个并不是 polyfill ，因为它在功能上并不相同； \n * setTimeout() 并不会让你利用空闲时段，而是使你的代码在情况允许时执行你的代码，\n * 以使我们可以尽可能地避免造成用户体验性能表现延迟的后果。\n */\n// https://developer.mozilla.org/zh-CN/docs/Web/API/Background_Tasks_API \nwindow.requestIdleCallback = window.requestIdleCallback || function(handler) {\n    let startTime = Date.now();\n    return setTimeout(function() {\n      handler({\n        didTimeout: false,\n        timeRemaining: function() {\n          return Math.max(0, 50.0 - (Date.now() - startTime));\n        }\n      });\n    }, 1);\n};\n\nwindow.cancelIdleCallback = window.cancelIdleCallback || function(id) {\n    clearTimeout(id);\n};\n\n(()=>{\n    const loadConfig = async () => {\n        var url = (window.kr?.siteRoot || '/') + 'config/main.json';\n        return await (await fetch(url)).json()\n    };\n    const pageScrollDownInit = ()=>{\n        let isScrolledDown = false;\n        const pageScrollDownClass = () => {\n            window.requestAnimationFrame(() => {\n                if (window.scrollY > 200){\n                    if (!isScrolledDown) {\n                        document.body.classList.add('scroll-down');\n                        isScrolledDown = true;\n                    }\n                } else {\n                    if (isScrolledDown) {\n                        document.body.classList.remove('scroll-down');\n                        isScrolledDown = false;\n                    }\n                }\n            });\n        };\n        $('.gotop-box').on('click',function(event){\n            // event.preventDefault();\n            $('html, body').animate({\n                scrollTop:$('html').offset().top\n            },500);\n            return false;\n        });\n        pageScrollDownClass();\n        window.addEventListener('scroll', pageScrollDownClass);\n    };\n    const offcanvas = ()=>{\n        let $clone = $('#kratos-menu-wrap').clone();\n        $clone.attr({\n            'id':'offcanvas-menu'\n        });\n        $clone.find('> ul').attr({\n            'id':''\n        }).addClass('ul-me');\n        $('#kratos-page').prepend($clone);\n        $('.js-kratos-nav-toggle').on('click',()=>{\n            if($('.nav-toggle').hasClass('toon')){\n                $('.nav-toggle').removeClass('toon');\n                $('#offcanvas-menu').css('right','-240px');\n            }else{\n                $('.nav-toggle').addClass('toon');\n                $('#offcanvas-menu').css('right','0px');\n            }\n        });\n        $('#offcanvas-menu').css('height',$(window).height());\n        $('#offcanvas-menu').css('right','-240px');\n        $(window).resize(()=>{\n            const w = $(window);\n            $('#offcanvas-menu').css('height',w.height());\n            if(w.width()>769){\n                if($('.nav-toggle').hasClass('toon')){\n                    $('.nav-toggle').removeClass('toon');\n                    $('#offcanvas-menu').css('right','-240px');\n                }\n            }\n        });\n    };\n    const mobiClick = ()=>{\n        $(document).click((e)=>{\n            const container = $(\"#offcanvas-menu,.js-kratos-nav-toggle\");\n            if (!container.is(e.target) && container.has(e.target).length === 0) {\n                if ($('.nav-toggle').hasClass('toon')) {\n                    $('.nav-toggle').removeClass('toon');\n                    $('#offcanvas-menu').css('right','-240px');\n                }\n            }\n        });\n    };\n    const xControl = ()=>{\n        $(document).on(\"click\",\".xHeading\", function(event){\n            $(this).next().slideToggle(300);\n            if ($(this).parent('.xControl').hasClass('active')) {\n                $(this).parent('.xControl').removeClass('active');\n            } else {\n                $(this).parent('.xControl').addClass('active');\n            }\n            event.preventDefault();\n        });\n    };\n\n    const donateConfig = (kr)=>{\n        $(document).on(\"click\",\".donate\",()=>{\n            layer.open({\n                type:1,\n                area:['300px', '370px'],\n                title:kr.donateBtn,\n                resize:false,\n                scrollbar:false,\n                content:'<div class=\"donate-box\"><div class=\"meta-pay text-center\"><strong>'+kr.scanNotice+'</strong></div><div class=\"qr-pay text-center\"><img class=\"pay-img\" id=\"alipay_qr\" src=\"'+kr.qr_alipay+'\"><img class=\"pay-img d-none\" id=\"wechat_qr\" src=\"'+kr.qr_wechat+'\"></div><div class=\"choose-pay text-center mt-2\"><input id=\"alipay\" type=\"radio\" name=\"pay-method\" checked><label for=\"alipay\" class=\"pay-button\"><img src=\"/images/alipay.webp\"></label><input id=\"wechatpay\" type=\"radio\" name=\"pay-method\"><label for=\"wechatpay\" class=\"pay-button\"><img src=\"/images/wechat.webp\"></label></div></div>'\n            });\n            $(\".choose-pay input[type='radio']\").click(function(){\n                const id = $(this).attr(\"id\");\n                if (id == 'alipay') {\n                    $(\".qr-pay #alipay_qr\").removeClass('d-none');\n                    $(\".qr-pay #wechat_qr\").addClass('d-none');\n                }\n                if (id == 'wechatpay') {\n                    $(\".qr-pay #alipay_qr\").addClass('d-none');\n                    $(\".qr-pay #wechat_qr\").removeClass('d-none');\n                }\n            });\n        });\n    };\n\n    const shareMenu = ()=>{\n        $(document).on(\"click\",\".share\",()=>{$(\".share-wrap\").fadeToggle(\"slow\");});\n    };\n\n    const loadRandomCover = (kr)=>{\n        // 图片\n        const imageboxs = document.getElementsByClassName(\"kratos-entry-thumb-new-img\");\n        const randomAmount = kr.cover && kr.cover.randomAmount || 20;\n        const baseUrl = kr.cover && kr.cover.baseUrl || 'https://cdn.jsdelivr.net/npm/hexo-theme-kratos-rebirth@latest/source/images/thumb/'\n        const coverFileNameTemplate = kr.cover && kr.cover.filenameTemplate || \"thumb_{no}.webp\";\n        const usedCovers = new Array(randomAmount + 1);\n\n        const generateNewCoverID = () => {\n            let remailFailCounts = 5; // set max fail counts\n            let coverNo;\n            while (remailFailCounts > 0) {\n                // rand one\n                coverNo = Math.floor(Math.random() * randomAmount + 1);\n                if (!usedCovers[coverNo]) {\n                    // valid\n                    break;\n                } else {\n                    // fails\n                    remailFailCounts--;\n                }\n            }\n\n            if (remailFailCounts <= 0) {\n                // rand failed, find one manually\n                coverNo = -1;\n                for (let i = 1; i <= randomAmount; i++) {\n                    if (!usedCovers[i]) {\n                        // use first\n                        coverNo = i;\n                        break;\n                    }\n                }\n                if (coverNo === -1) {\n                    // All used\n                    // clear all\n                    for (let i = 1; i <= randomAmount; i++) {\n                        usedCovers[i] = false;\n                    }\n                    // rand one\n                    coverNo = Math.floor(Math.random() * randomAmount + 1);\n                }\n            }\n\n            // mark as used\n            usedCovers[coverNo] = true;\n            \n            // return\n            return coverNo;\n        }\n\n        for (let i = 0, len = imageboxs.length; i < len; i++) {\n            if (!($(imageboxs[i]).attr(\"src\"))) {\n                const coverNo = generateNewCoverID();\n                const coverFileName = coverFileNameTemplate.replace(\"{no}\", coverNo.toString());\n                let coverUrl;\n                if (coverFileName.includes(\"//\")) {\n                    coverUrl = coverFileName;\n                } else if (baseUrl.substring(baseUrl.length - 1) === \"/\") {\n                    coverUrl = baseUrl + coverFileName;\n                } else {\n                    coverUrl = baseUrl + '/' + coverFileName;\n                }\n                $(imageboxs[i]).attr(\"src\", coverUrl);\n            }\n        }\n    };\n\n    const fancyboxInit = ()=>{\n          if (typeof $.fancybox !== 'undefined'){\n            $.fancybox.defaults.hash = false;\n            $('.kratos-hentry').each(function(i){\n                $(this).find('img').each(function(){\n                  if ($(this).parent().hasClass('fancybox') || $(this).parent().hasClass('qrcode') || $(this).parent().is('a')) return;\n                  const alt = this.alt;\n                  if (alt) $(this).after('<span class=\"caption\">' + alt + '</span>');\n                  $(this).wrap('<a rel=\"gallery\" href=\"' + this.src + '\" data-fancybox=\\\"gallery\\\" data-caption=\"' + alt + '\"></a>')\n                });\n            });\n            $('.fancybox').fancybox();\n          }\n    };\n\n    const tocNavInit = ()=>{\n        $(document).on(\"click\", 'a[class=toc-link]', function(){\n            $('html, body').animate({\n                scrollTop:$(decodeURI($(this).attr(\"href\"))).offset().top - 60\n            },500);\n            return false;\n        });\n    };\n\n    let copyrightString;\n    const setCopyright = (kr)=>{\n        copyrightString = `\n\n-------------------------\n${kr.copyrightNotice}\n作者：${document.querySelector(\"meta[name='author']\").getAttribute('content')}\n来源：${document.title}\n链接：${window.location.href}\n`;\n    }\n\n    const copyEventInit = (kr)=>{\n        if (kr.copyrightNotice) {\n            document.body.oncopy = (e)=>{\n                if (copyrightString) {\n                    const copiedContent = window.getSelection().toString();\n                    if (copiedContent.length > 150) {\n                        e.preventDefault();\n                        if (e.clipboardData) {\n                            e.clipboardData.setData(\"text/plain\", copiedContent + copyrightString);\n                        }\n                    }\n                }\n            };\n        }\n    };\n\n    let docTitle = '';\n    const saveTitle = () => {\n        docTitle = document.title;\n    };\n\n    const leaveEventInit = (kr) => {\n        if (kr.siteLeaveEvent) {\n            let titleTime;\n            const OriginLogo = $('[rel=\"icon\"]').attr(\"href\");\n            document.addEventListener('visibilitychange', ()=>{\n                if (document.hidden) {\n                    document.title = kr.leaveTitle;\n                    if (kr.leaveLogo) {\n                        $('[rel=\"icon\"]').attr(\"href\", kr.leaveLogo);\n                    }\n                    clearTimeout(titleTime);\n                } else {\n                    document.title = kr.returnTitle + \" \" + docTitle;\n                    if (kr.leaveLogo) {\n                        $('[rel=\"icon\"]').attr(\"href\", OriginLogo);\n                    }\n                    titleTime = setTimeout(()=>{\n                        document.title = docTitle;\n                        titleTime = 0;\n                    }, 2000);\n                }\n            });\n        }\n    };\n\n    const getTimeString = (msec, exact = true) => {\n        let tString;\n        const sec = msec / 1000;\n        const dnum = Math.floor(sec / 60 / 60 / 24);\n        const hnum = Math.floor(sec / 60 / 60 - (24 * dnum));\n        const mnum = Math.floor(sec / 60 - (24 * 60 * dnum) - (60 * hnum));\n        const snum = Math.floor(sec - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum));\n        let dstr = dnum.toString();\n        let hstr = hnum.toString();\n        let mstr = mnum.toString();\n        let sstr = snum.toString();\n        if (exact) {\n            if (dstr && dstr.length === 1) {\n                dstr = '0' + dstr;\n            }\n            if (hstr && hstr.length === 1) {\n                hstr = '0' + hstr;\n            }\n            if (mstr && mstr.length === 1) {\n                mstr = '0' + mstr;\n            }\n            if (sstr && sstr.length === 1) {\n                sstr = '0' + sstr;\n            }\n            tString = dstr + \"天\" + hstr + \"小时\" + mstr + \"分\" + sstr + \"秒\";\n        } else {\n            // 大概值\n            if (dnum < 540) {\n                // 一年半内\n                if (dnum < 60) {\n                    // 两个月内\n                    tString = dstr + \"天\";\n                } else {\n                    // 年内月外\n                    tString = Math.floor(dnum / 30).toString() + '个月';\n                }\n            } else {\n                // 年外\n                tString = Math.floor(dnum / 365).toString() + '年';\n            }\n        }\n        return tString;\n    };\n\n    const initTime = (kr) => {\n        const createTime = new Date(kr.createTime);\n        const upTimeNode = document.getElementById(\"span_dt\");\n        setInterval(() => {\n            upTimeNode.innerText = getTimeString(Date.now() - createTime);\n        }, 1000);\n    };\n\n    const codeCopyInit = () => {\n        // 使用了clipboard.js，所以非常的简洁，只需在前端生成对应的按钮和指定代码框的ID即可\n        const codeFigures = document.querySelectorAll('figure.highlight');\n        codeFigures.forEach((figure, count) => {\n            figure\n                .getElementsByTagName('table')[0]\n                .getElementsByTagName('tbody')[0]\n                .getElementsByTagName('tr')[0]\n                .getElementsByClassName('code')[0]\n            .setAttribute('id', `code-${count}`);\n\n            figure.innerHTML += \n            `<button class=\"copy\" data-clipboard-target=\"#code-${count}\">\n                <i class=\"fa fa-copy\"></i>&nbsp;复制\n            </button>`;\n        });\n\n        const clipboard = new ClipboardJS('button.copy');\n\n        clipboard.on('success', (e) => {\n            const origInner = e.trigger.innerHTML;\n            e.trigger.innerHTML = `<i class=\"fa fa-check-circle\"></i>&nbsp;成功~`;\n            setTimeout(() => {\n                e.trigger.innerHTML = origInner;\n            }, 3000);\n\n            e.clearSelection();\n        });\n    };\n\n    const commentsLazyLoad = () => {\n        // 检查当前是否在浏览器中运行\n        const runningOnBrowser = typeof window !== \"undefined\";\n        // 通过检查 scroll 事件 API 和 User-Agent 来匹配爬虫\n        const isBot = runningOnBrowser && !(\"onscroll\" in window) || typeof navigator !== \"undefined\" && /(gle|ing|ro|msn)bot|crawl|spider|yand|duckgo/i.test(navigator.userAgent);\n        // 检查当前浏览器是否支持 IntersectionObserver API\n        const supportsIntersectionObserver = runningOnBrowser && \"IntersectionObserver\" in window;\n        // 需要懒加载的评论区块\n        const commsArea = document.querySelector('.post-comments.lazy-load');\n        // 加载评论的函数\n        const loadwork = () => {\n            if (window.loadCommentsEventHandler) {\n                // 取消上一个加载事件\n                window.cancelIdleCallback(window.loadCommentsEventHandler);\n            }\n            if (typeof load_comm === 'undefined' || load_comm === null) {\n                return;\n            }\n            // 加载新评论模块\n            window.loadCommentsEventHandler = window.requestIdleCallback(load_comm);\n            // 防止二次加载，清理掉函数\n            load_comm = null;\n        };\n        if (runningOnBrowser && !isBot && supportsIntersectionObserver && commsArea !== null) {\n            const observer = new IntersectionObserver((entries) => {\n                if (entries[0].isIntersecting) {\n                    loadwork();\n                    observer.disconnect();\n                }\n            }, { threshold: 0 });\n            observer.observe(commsArea);\n        } else {\n            loadwork();\n        }\n    };\n\n    const expireNotify = (kr) => {\n        if (kr.expire_day) {\n            const expireAlert = document.getElementById('expire-alert');\n            if (expireAlert) {\n                const dateTimeTag = expireAlert.querySelector('time');\n                const updateDateTime = new Date(parseInt(dateTimeTag.getAttribute('datetime')));\n                const nowDateTime = Date.now();\n                const gap = nowDateTime - updateDateTime;\n                if (gap > kr.expire_day * 24 * 3600 * 1000) {\n                    // 内容可能过期，需要提示\n                    dateTimeTag.innerText = getTimeString(gap, false);\n                    expireAlert.classList.remove('hidden');\n                }\n            }\n            \n        }\n    };\n\n    const makeDelay = (callback, ms) => {\n        var timer = 0;\n        return function () {\n            var context = this, args = arguments;\n            clearTimeout(timer);\n            timer = setTimeout(function () {\n                callback.apply(context, args);\n            }, ms || 0);\n        };\n    }\n\n    const tocWidgetAnimInit = () => {\n        const sidebarTocWidget = document.getElementById('krw-toc');\n        const initFunc = () => {\n            // 有toc的页面\n            // 获取侧边栏所有的toc项\n            const tocDOMs = sidebarTocWidget.getElementsByClassName('toc-item');\n            // 元素高度映射记录\n            const tocItems = [];\n            try {\n                Array.from(tocDOMs).forEach((tocItem) => {\n                    const linkItem = tocItem.querySelector('.toc-link');\n                    const titleText = decodeURI(linkItem.getAttribute('href'));\n                    if (titleText.substring(0, 1) != '#') {\n                        throw new Error('TOC 小标题链接无效，格式无限');\n                    }\n                    const titleElem = document.getElementById(titleText.substring(1));\n                    if (!titleElem) {\n                        throw new Error('TOC 小标题链接无效，未找到相关引用');\n                    }\n                    titleElem.setAttribute(\"data-toc-id\", tocItems.length)\n                    tocItems.push({\n                        at: titleElem,\n                        el: tocItem\n                    });\n                });\n            } catch (e) {\n                console.log('错误：', e.message);\n                Array.from(tocDOMs).forEach((tocItem) => {\n                    tocItem.classList.add('show');\n                });\n                return;\n            }\n\n            // 初始化为不存在的标题\n            let curTocId = -1;\n            // 标题激活状态修改函数\n            const tocActivate = (newId) => {\n                if (curTocId === newId) {\n                    // Do nothing...\n                    return;\n                }\n                if (curTocId !== -1) {\n                    // 清除旧标题激活状态\n                    tocItems[curTocId].el.classList.remove('active');\n                    tocItems[curTocId].el.classList.remove('show');\n                    // 清除旧元素层级展示状态\n                    let nCur = tocItems[curTocId].el\n                    while (!nCur.classList.contains('toc')) {\n                        if (nCur.classList.contains('toc-item')) {\n                            nCur.classList.remove('show');\n                        }\n                        nCur = nCur.parentNode;\n                    }\n                }\n                if (newId !== -1) {\n                    // 构建新标题激活状态\n                    tocItems[newId].el.classList.add('active');\n                    tocItems[newId].el.classList.add('show');\n                    // 建立新元素层级展示状态\n                    let nCur = tocItems[newId].el\n                    while (!nCur.classList.contains('toc')) {\n                        if (nCur.classList.contains('toc-item')) {\n                            nCur.classList.add('show');\n                        }\n                        nCur = nCur.parentNode;\n                    }\n                }\n                curTocId = newId;\n            };\n\n            if (\"IntersectionObserver\" in window) {\n                const applyDecision = makeDelay((i, pos) => {\n                    if (pos === window.scrollY) {\n                        window.requestAnimationFrame(() => {\n                            tocActivate(i);\n                        });\n                    } else {\n                        applyDecision(i, window.scrollY);\n                    }\n                }, 100)\n\n                const observer = new IntersectionObserver((entries) => {\n                    let decision = null\n                    entries.forEach((entry) => {\n                        const currentIndex = Number.parseInt(entry.target.getAttribute('data-toc-id'), 10);\n                        if (!entry.isIntersecting\n                            && entry.boundingClientRect.top <= entry.rootBounds.top) {\n                            decision = currentIndex\n                        } else if (entry.isIntersecting\n                            && entry.boundingClientRect.bottom < entry.rootBounds.top + entry.rootBounds.height / 2\n                            && entry.intersectionRatio === 1) {\n                            decision = currentIndex - 1\n                        }\n                    })\n                    if (decision !== null) {\n                        applyDecision(decision, window.scrollY);\n                    }\n                }, {\n                    rootMargin: '-62px 0px 0px 0px',\n                    threshold: 1.0,\n                })\n                tocItems.forEach((x) => {\n                    observer.observe(x.at)\n                });\n                window.addEventListener('pjax:before', () => {\n                    observer.disconnect();\n                    tocItems.length = 0; // 奇妙的数组清空方式\n                }, { once: true });\n            } else {\n                const tocUpdatePos = () => {\n                    tocItems.forEach((x) => {\n                        x.h = x.at.getBoundingClientRect().top + window.scrollY - 61 // 比 click 事件那里多减掉1，避免浏览器 round 后导致的判断失败\n                    });\n                };\n\n                tocUpdatePos();\n\n                // 标题定位函数\n                const tocGetId = () => {\n                    let newPos;\n                    if (!Number.isInteger(curTocId) || curTocId < 0 || curTocId > tocItems.length - 1) {\n                        newPos = 0;\n                    } else {\n                        newPos = curTocId;\n                    }\n                    const nowY = window.scrollY;\n                    if (nowY >= tocItems[newPos].h) {\n                        if (nowY >= tocItems[tocItems.length - 1].h) {\n                            newPos = tocItems.length - 1;\n                        } else {\n                            while (nowY >= tocItems[newPos + 1].h) {\n                                newPos++;\n                            }\n                        }\n                    } else {\n                        while (nowY < tocItems[newPos].h) {\n                            newPos--;\n                            if (newPos < 0) break;\n                        }\n                    }\n                    return newPos;\n                }\n\n                // 处理事件的函数\n                const tocOnScroll = makeDelay(() => {\n                    window.requestAnimationFrame(() => {\n                        tocActivate(tocGetId());\n                    });\n                }, 100);\n\n                const tocOnResize = makeDelay(() => {\n                    tocUpdatePos();\n                    window.requestAnimationFrame(() => {\n                        tocActivate(tocGetId());\n                    });\n                }, 100);\n\n                window.addEventListener(\"resize\", tocOnResize);\n                window.addEventListener('scroll', tocOnScroll);\n                // pjax前销毁\n                window.addEventListener('pjax:before', () => {\n                    window.removeEventListener('resize', tocOnResize);\n                    window.removeEventListener('scroll', tocOnScroll);\n                    tocItems.length = 0; // 奇妙的数组清空方式\n                }, { once: true });\n            }\n\n            // 阅读进度\n            const readProgBar = document.getElementsByClassName('toc-progress-bar')[0];\n            const articleElem = document.querySelector('.kratos-post-content');\n            const setPercent = () => {\n                // 参考 Butterfly 主题相关实现\n                // https://github.com/jerryc127/hexo-theme-butterfly/blob/c1ac4a5e167f7bb26287fc9ca32a182cfc293231/source/js/main.js#L337-L346\n                if (articleElem) {\n                    const currentTop = window.scrollY || document.documentElement.scrollTop\n                    const docHeight = articleElem.clientHeight\n                    const winHeight = document.documentElement.clientHeight\n                    const headerHeight = articleElem.offsetTop\n                    const contentMath =\n                        (docHeight > winHeight) ?\n                            (docHeight - winHeight) :\n                            (document.documentElement.scrollHeight - winHeight)\n                    const scrollPercent = Math.max(0, Math.min((currentTop - headerHeight) / (contentMath), 1))\n                    const scrollPercentRound = Math.round(scrollPercent * 100)\n                    readProgBar.style.width = (scrollPercent * 100).toString() + '%';\n                    readProgBar.setAttribute('aria-valuenow', scrollPercentRound);\n                }\n            }\n            window.addEventListener('scroll', () => {\n                window.requestAnimationFrame(setPercent);\n            });\n            setPercent(); // 初始运行一次\n        }\n        if (sidebarTocWidget) {\n            if (sidebarTocWidget.offsetParent !== null) {\n                initFunc();\n            } else if (\"IntersectionObserver\" in window) {\n                // Init when become visible\n                new IntersectionObserver(initFunc, {\n                    threshold: 0,\n                    once: true,\n                }).observe(sidebarTocWidget);\n            }\n        }\n    };\n\n    const topNavScrollToggleInit = (kr) => {\n        // 判断设置参数\n        if (!kr.topNavScrollToggle) {\n            return; // 没有启用\n        }\n        // 记录上一次滚动高度，用于判断滚动方向\n        let lastHeight = window.innerHeight;\n        // 记录顶部栏隐藏状态\n        let isTopNavHidden = false;\n\n        // 处理事件的函数\n        const handleTopNavScrollToggle = () => {\n            window.requestAnimationFrame(() => {\n                if (lastHeight < window.scrollY) {\n                    // 向下滚动\n                    if (!isTopNavHidden) {\n                        document.body.classList.add('nav-up');\n                        isTopNavHidden = true;\n                    }\n                } else if (lastHeight > window.scrollY) {\n                    // 向上滚动\n                    if (isTopNavHidden) {\n                        document.body.classList.remove('nav-up');\n                        isTopNavHidden = false;\n                    }\n                }\n                // 相等则不做处理\n                lastHeight = window.scrollY;\n            });\n        };\n\n        // 仅处理鼠标滚动\n        window.addEventListener('wheel', handleTopNavScrollToggle);\n\n    };\n\n    const initPerPage = () => {\n        tocWidgetAnimInit();\n        saveTitle();\n        codeCopyInit();\n        fancyboxInit();\n        commentsLazyLoad();\n    };\n\n    const initPerPageWithConfig = kr => {\n        loadRandomCover(kr);\n        setCopyright(kr);\n        expireNotify(kr);\n    };\n\n    window.addEventListener('pjax:complete', () => {\n        initPerPage();\n        if (typeof MathJax !== 'undefined') {\n            MathJax.Hub.Typeset();\n        }\n    });\n\n    function themeInit() {\n        document.removeEventListener(\"DOMContentLoaded\", themeInit, false);\n        window.removeEventListener(\"load\", themeInit, false);\n\n        loadConfig().then(kr => {\n            copyEventInit(kr);\n            leaveEventInit(kr);\n            initTime(kr);\n            donateConfig(kr);\n            topNavScrollToggleInit(kr);\n            initPerPageWithConfig(kr);\n            window.addEventListener('pjax:complete', () => {\n                initPerPageWithConfig(kr);\n            });\n        });\n        \n        pageScrollDownInit();\n        offcanvas();\n        mobiClick();\n        xControl();\n        shareMenu();\n        tocNavInit();\n        initPerPage();\n    }\n\n    if (document.readyState === \"complete\") {\n        setTimeout(themeInit);\n    } else {\n        document.addEventListener(\"DOMContentLoaded\", themeInit, false);\n        window.addEventListener(\"load\", themeInit, false); //fallback\n    }\n})();\n"]}